
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>Ticket to Ride: Europe - Random Tickets</title>
	<style type="text/css">
		body { font-size: 14px; }
		table {  border: solid 1px black; margin-bottom: 10px; font-size: 14px; }
		th { background: #BBBBBB; }
		td { text-align: center; border: solid 1px #BBBBBB; }
		input[type=text] { text-align: right; width: 40px; }
		.column { float: left; margin: 20px 20px 0 0; }
		.ticket { margin: 0 0 20px 0; border: solid 1px black; height: 100px; width: 300px; padding: 5px; }
	</style>
</head>
<body>
<p><a href="../ticket.html">More</a></p>
<h1>Ticket to Ride: Europe Tickets</h1>
<table>
	<tr>
		<td colspan="3" rowspan="2"><input type="radio" name="rule" value="0"/> Fully random</td>
		<td colspan="6"><input type="radio" name="rule" value="1"/> Short/long</td>
	</tr>
	<tr>
		<td colspan="3">Short</td>
		<td colspan="3">Long</td>
	</tr>
	<tr>
		<td>Nr</td>
		<td>Min</td>
		<td>Max</td>
		<td>Nr</td>
		<td>Min</td>
		<td>Max</td>
		<td>Nr</td>
		<td>Min</td>
		<td>Max</td>
	</tr>
	<tr>
		<td><input type="text" name="frnr" value="40"/></td>
		<td><input type="text" name="frmin" value="0"/></td>
		<td><input type="text" name="frmax" value="30"/></td>
		<td><input type="text" name="slsnr" value="40"/></td>
		<td><input type="text" name="slsmin" value="5"/></td>
		<td><input type="text" name="slsmax" value="15"/></td>
		<td><input type="text" name="sllnr" value="6"/></td>
		<td><input type="text" name="sllmin" value="20"/></td>
		<td><input type="text" name="sllmax" value="30"/></td>
	</tr>
</table>
<input type="button" value="Generate" onclick="generatePaths();"/>
<div id="output">
	<div id="col1" class="column"></div>
	<div id="col2" class="column"></div>
	<div id="long" class="column"></div>
</div>

<script type="text/javascript">
	function $(id) { return document.getElementById(id); }

	var stations = ["Amsterdam", "Angora", "Athína", "Barcelona", "Berlin", "Brest", "Brindisi", "Bruxelles", "Bucuresti", "Budapest", "Cádiz", "Constantinople", "Danzig", "Dieppe", "Edinburgh", "Erzurum", "Essen", "Frankfurt", "Kharkov", "Kyïv", "København", "Lisboa", "London", "Madrid", "Marseille", "Moskva", "München", "Palermo", "Pamplona", "Paris", "Petrograd", "Riga", "Roma", "Rostov", "Sarajevo", "Sevastopol", "Smolensk", "Smyrna", "Sochi", "Sofia", "Stockholm", "Venezia", "Warszawa", "Wien", "Wilno", "Zágráb", "Zürich"];
	var routes = [[ 0, -1, -1, -1, -1, -1, -1,  1, -1, -1, -1, -1, -1, -1, -1, -1,  3,  2, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1,  0, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1,  0, -1, -1, -1,  4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4, -1, -1,  2, -1,  3, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2,  4, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1,  4, -1, -1, -1,  2,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4,  3, -1, -1, -1],
				  [-1, -1, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1,  4, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [ 1, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1, -1, -1,  2, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1,  0,  4, -1,  3, -1, -1, -1, -1, -1, -1, -1,  4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1,  4,  0, -1, -1, -1, -1, -1, -1, -1, -1, -1,  6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1,  1, -1,  2, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1,  2, -1, -1, -1, -1, -1, -1,  3, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4, -1,  2, -1,  3, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1, -1,  4, -1, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1],
				  [-1, -1, -1, -1, -1,  2, -1,  2, -1, -1, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1,  1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1,  4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1],
				  [ 3, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  0,  2, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [ 2, -1, -1, -1,  3, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1,  2,  0, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  0,  4, -1, -1, -1, -1, -1,  4, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1,  4,  6, -1, -1, -1, -1, -1, -1, -1, -1,  4,  0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1,  4, -1,  2, -1, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  0, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [ 2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2,  4, -1, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1,  2, -1, -1, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3, -1,  0, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1,  4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1,  4,  4, -1, -1,  4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1, -1,  4, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1,  3, -1, -1,  2],
				  [-1, -1, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1, -1,  4, -1, -1, -1, -1,  6, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1,  2, -1,  4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3,  4, -1, -1, -1,  0,  4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1, -1, -1,  3, -1,  2, -1, -1, -1, -1, -1,  1, -1, -1, -1,  3, -1, -1, -1, -1, -1, -1,  4, -1, -1, -1,  4,  0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4, -1, -1, -1, -1,  0,  4, -1, -1, -1, -1, -1, -1, -1, -1,  8, -1, -1, -1,  4, -1, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4,  0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4, -1, -1],
				  [-1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4, -1, -1,  4, -1, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  0, -1,  4, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1,  4, -1, -1, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1,  3, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1,  4, -1, -1,  4, -1, -1, -1,  4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4, -1,  0, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1,  3, -1, -1],
				  [-1,  3,  2, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  6, -1, -1, -1, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1,  2, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1,  3, -1, -1, -1, -1, -1,  2, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1,  8, -1, -1, -1, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1, -1, -1, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1,  2,  2],
				  [-1, -1, -1, -1,  4, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1,  4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  0,  4,  3, -1, -1],
				  [-1, -1, -1, -1,  3, -1, -1, -1, -1,  1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4,  0, -1,  2, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  4,  4, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1,  3, -1,  0, -1, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  3, -1, -1, -1, -1, -1, -1,  2, -1,  2, -1,  0, -1],
				  [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1,  2, -1, -1,  3, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  2, -1, -1, -1, -1,  0]];

	var tickets = findShortestPaths(stations, routes);

	function generatePaths()
	{
		
        getPaths(tickets.slice(), 4,1,40, 'main');

	}

	function getPaths(t, nr, min, max, target)
	{
		var div = target == 'main' ? 'col1' : target;

		for(var j = 0; j < t.length; j++)
		{
			if(t[j][2] < min || t[j][2] > max) { t.splice(j--, 1); }
		}

		if(t.length < nr)
		{
			$('col1').innerHTML += 'Not enough tickets matched your criteria.';
		}
		else
		{
			for(var i = 0; i < nr; i++)
			{
				if(div == 'col1' && i >= nr / 2) { div = 'col2'; }

				var pick = t.splice(Math.floor(Math.random() * t.length), 1);

				$(div).innerHTML += '<div class="ticket ' + target + '">' + (i+1) + ': ' + pick[0][0] + '-' + pick[0][1] + ' (' + pick[0][2]  + ')</div>';
			}
			$(div).innerHTML += '</div>';
		}
	}

	function findShortestPaths(stations, routes)
	{
		var table = [];
		var tickets = [];

		function addOptions(station, distance)
		{
			for(var k = 0; k < routes[station].length; k++)
			{
				if(routes[station][k] > 0 && distances[k] == -1 && (options[k] == -1 || routes[station][k] + distance < options[k]))
				{
					options[k] = routes[station][k] + distance;
				}
			}
		}

		for(var i = 0; i < routes.length; i++)
		{
			var options = routes[i].slice();
			var distances = [];
			for(var j = 0; j < stations.length; j++) { distances[j] = -1; }
			var go = true;

			while(go)
			{
				var len = 1000;
				var pick = -1;

				for(var k = 0; k < options.length; k++)
				{
					if(options[k] > 0 && options[k] < len)
					{
						pick = k;
						len = options[k]
					}
				}

				if(pick != -1)
				{
					distances[pick] = len;
					options[pick] = -1;
					addOptions(pick, len);
				}
				else
				{
					go = false;
				}
			}

			table.push(distances);
		}

		for(i = 0; i < table.length; i++)
		{
			for(j = 0; j < table[i].length; j++)
			{
				if(routes[i][j] <= 0 && i < j && j < table[i].length) { tickets.push([stations[i], stations[j], Number(table[i][j])]); }
			}
		}

		return tickets;
	}

</script>
</body>
</html>